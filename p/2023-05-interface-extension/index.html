<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="always learning | always growing">

    <title>Always Developing - Sharing a common method across classes</title>

    <link rel="canonical" href="https://alwaysdeveloping.net/p/2023-05-interface-extension">

            <link type="application/rss+xml" rel="alternate" href="/feed.rss" />
            <link type="application/atom+xml" rel="alternate" href="/feed.atom" />

    <meta name="application-name" content="Always Developing" />
    <meta name="msapplication-tooltip" content="Always Developing" />
    <meta name="msapplication-starturl" content="/" />

    <meta property="og:title" content="Always Developing - Sharing a common method across classes" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://alwaysdeveloping.net/p/2023-05-interface-extension" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">

    <!-- Bootstrap core CSS -->
    <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>

    <!-- Custom styles for this template -->
    <link href="/scss/always-developing-blog.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
    <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

    <!-- Lunr search -->
        <script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/pako@2.0.3/dist/pako_inflate.min.js"></script>
        <script src="/search.js"></script>

    


    

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
    <div class="container">
        <a class="navbar-brand"  href="/">
            <img src="/images/ad_logo.png" alt="" width="25" height="25" class="d-inline-block align-text-top">
            Always Developing
        </a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
            <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="/software">Software</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/tags">Tags</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/posts">Posts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/about">About</a>
            </li>
</ul>
                <form class="form-inline my-2 my-lg-0" action="/search" method="GET">
                    <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="query">
                    <input type="submit" hidden />
                </form>
        </div>
    </div>
</nav>

    <!-- Page Header -->
    <header class="masthead">
    <div class="container">
        <div class="row">
            <div class="col-md-2 align-middle">
                <div class="post-header-image">
                    <a href="/">
                        <img src="/images/ad_logo.png" class="header-image">
                    </a>
                </div>
            </div>
            <div class="col-md-10">
                <div class="post-heading">
                    <h1>
                        Sharing a common method across classes
                    </h1>
                            <h2 class="subheading">Leverage interfaces and extension methods and to share a common method</h2>
                        <p class="post-meta">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16">
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H2z" />
                                <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5V4zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1z" />
                            </svg> Published on Friday, 26 May 2023
                        </p>
                </div>
            </div>
        </div>
    </div>
</header>

    <!-- Main Content -->
    <div class="container">
            <div class="row ">
                    <div id="content" class="col-md-9 post-with-toc post-block">
                        
<div class="post-header-category">
    <a class="btn btn-primary btn-sm btn-default btn-home" href="\" role="button"><i class="fas fa-angle-double-left"></i> Home</a>
            <a class="btn btn-primary btn-sm category-btn" href="/categories/blog" role="button">Blog</a>
</div>

                        <h2 id="introduction">Introduction</h2>
<p>Have you needed to add the same method to multiple classes? To have a single method in the code applied to multiple classes, instead of duplicating the code in multiple places?</p>
<p>This article will detail a technique (which I have personally been using extensively) which <code>allows for a single extension method to easily be added to any class</code>.</p>
<hr />
<h2 id="inheritance">Inheritance</h2>
<p>Before getting to the extension method technique, we are going to have a quick look at using inherence to solve the problem. A common method in a base class can be used to add the functionality to child classes:</p>
<pre><code class="language-csharp">// BaseClass which has common functionality
public class BaseClass
{
    public BaseClass ExecuteBaseFunctionality()
    {
        Console.WriteLine(&quot;Executing Common functionality&quot;);
        return this;
    }
}

// Class1 which can execute Class1 specific functionality
// as well as the common functionality
public class Class1 : BaseClass
{
    public Class1 ExecuteClass1Functionality()
    {
        Console.WriteLine(&quot;Executing Class1 functionality&quot;);
        return this;
    }
}

// Class2 which can execute Class2 specific functionality
// as well as the common functionality
public class Class2 : BaseClass
{
    public Class2 ExecuteClass2Functionality()
    {
        Console.WriteLine(&quot;Executing Class2 functionality&quot;);
        return this;
    }
}
</code></pre>
<p>The reason for returning the <strong>class type</strong> from the methods, is to allow for <strong>method chaining</strong> to take place:</p>
<pre><code class="language-csharp">Class1 c1 = new Class1();

c1.ExecuteClass1Functionality()
    .ExecuteBaseFunctionality();

</code></pre>
<p>However, if the common functionality (a call to the base class method) is required to be executed first, then a cast is required:</p>
<pre><code class="language-csharp">Class1 c1 = new Class1();

((Class1)c1.ExecuteBaseFunctionality())
            .ExecuteBaseFunctionality();
</code></pre>
<p>Not ideal, but also not a big issue.</p>
<p>One big limitation of the inheritance approach is that if the class (<code>Class1</code> or <code>Class2</code> in this example) already inherits from another class, then the inheritance method simple will not work as C# does not allow for multiple inheritance:</p>
<pre><code class="language-csharp">// Already inherits, cannot inherit from &quot;BaseClass&quot;
public class Class1 : AnotherBaseClass
{
    public Class1 ExecuteClass1Functionality()
    {
        Console.WriteLine(&quot;Executing Class1 functionality&quot;);
        return this;
    }
}
</code></pre>
<p><code>Interfaces combined with extension methods</code> to the rescue!</p>
<hr />
<h2 id="interfaces-extension-methods">Interfaces + Extension Methods</h2>
<p>This technique may seem a bit complicated initially, and once the foundations have been setup it is incredibly easy and quick to add the common method to any class.</p>
<h3 id="defining-the-interface">Defining the interface</h3>
<p>The first step is to define a <code>marker interface</code> which will be used as the base for the extension method:</p>
<pre><code class="language-csharp">public interface IHasCommonFunctionality&lt;TParent&gt; 
    where TParent : class
{    
}
</code></pre>
<p>The interface uses a <em>generic parameter</em> to indicate the parent type - this is so the specific type can be returned from the extension methods to <em>enable method chaining</em> (shown further down in the post). If method chaining is not required, the generic parameter can be removed:</p>
<pre><code class="language-csharp">public interface IHasCommonFunctionality
{
}
</code></pre>
<hr />
<h3 id="defining-the-extension-method">Defining the extension method</h3>
<p>The next step, is to define an extension method, which <code>extends the functionality of the interface</code>:</p>
<pre><code class="language-csharp">public static class BaseFunctionalityExtensions
{
    // Extension method on IHasCommonFunctionality with a specific generic type parameter
    public static TParent ExecuteBaseFunctionality&lt;TParent&gt;(this IHasCommonFunctionality&lt;TParent&gt; parent)
        where TParent : class
    {
        Console.WriteLine(&quot;Executing Common functionality&quot;);

        // returns the parent, cast to the actual parent type
        return (TParent)parent;
    }
}
</code></pre>
<p>At first glace, there is a lot going on - but broken down:</p>
<ul>
<li>This is an extension method on the <code>IHasCommonFunctionality&lt;&gt;</code> interface. Any class which implements this interface, will have the <code>ExecuteBaseFunctionality</code> method available</li>
<li>The method uses the generic parameter <code>TParent</code> - this is the same parameter used when implementing the interface on a class, <code>IHasCommonFunctionality&lt;TParent&gt;</code></li>
<li>The method returns the generic parameter type (allowing for <em>method chaining</em>). As the returned <em>parent</em> variable is of type <code>IHasCommonFunctionality&lt;TParent&gt;</code>, and we want to return <code>TParent</code>, <em>parent</em> is cast to <code>TParent</code>.</li>
<li>The above cast will <em>always be valid</em> as the type represented by <code>TParent</code>, will always implement <code>IHasCommonFunctionality&lt;TParent&gt;</code></li>
</ul>
<p>A practical example might make it easier to see how the pieces fit together.</p>
<hr />
<h3 id="interface-implementation">Interface implementation</h3>
<p>The interface can now me implemented on one or many classes:</p>
<pre><code class="language-csharp">public class Class1 : IHasCommonFunctionality&lt;Class1&gt;
{
    public Class1 ExecuteClass1Functionality()
    {
        Console.WriteLine(&quot;Executing Class1 functionality&quot;);
        return this;
    }
}

public class Class2 : IHasCommonFunctionality&lt;Class2&gt;
{
    public Class2 ExecuteClass2Functionality()
    {
        Console.WriteLine(&quot;Executing Class2 functionality&quot;);
        return this;
    }
}
</code></pre>
<p>As you can see, the generic parameter for <code>IHasCommonFunctionality&lt;&gt;</code> is the <em>class the interface is being implemented on</em>. This gives the extension method visibility of the type that is leveraging the interface.</p>
<p>The extension method can now be leveraged from multiple classes::</p>
<pre><code class="language-csharp">Class1 c1 = new Class1();

// ExecuteBaseFunctionality called on Class1, and the 
// Class1 instance is returned allowing 
// ExecuteClass1Functionality to be called
c1.ExecuteBaseFunctionality()
    .ExecuteClass1Functionality();

//-----------

Class2 c2 = new Class2();

// ExecuteBaseFunctionality called on Class2, and the 
// Class2 instance is returned allowing 
// ExecuteClass2Functionality to be called
c2.ExecuteBaseFunctionality()
    .ExecuteClass2Functionality();
</code></pre>
<p>In the two example above, calling <code>ExecuteBaseFunctionality</code> on an instance of <code>Class1</code> returns the <em>Class1 instance</em> will calling the method on <code>Class2</code> returns the <em>Class2 instance</em>, allowing method chaining to still be possible.</p>
<hr />
<h2 id="conclusion">Conclusion</h2>
<p>When it's not possible to use inheritance to share a common method across multiple classes, the <code>interface + extension method</code> technique can prove to be very valuable. Once the ground work has been done, introducing the method to a class is as simple as having the class implement the required interface. In addition, as multiple interface implementations are allowed its possible add different extension methods to different classes independently (not possible with the inheritance technique)</p>
<p>I'm interested to know if this same problem has been solved in any other ways - please comment below with any additional techniques to leverage to solve the problem.</p>

                        
<div>
            <a role="button" href="/tags/c" class="badge badge-light"> c#</a>
            <a role="button" href="/tags/net" class="badge badge-light"> .net</a>
            <a role="button" href="/tags/extensionmethod" class="badge badge-light"> extensionmethod</a>
            <a role="button" href="/tags/extension" class="badge badge-light"> extension</a>
            <a role="button" href="/tags/interface" class="badge badge-light"> interface</a>
            <a role="button" href="/tags/generics" class="badge badge-light"> generics</a>
</div>
                    </div>
                    <div id="content" class="col-md-3 post-with-toc d-none d-lg-block">
                        

        <div class="box sticky-top toc-block">
            <h3 class="no-anchor">On This Page</h3>
            <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#inheritance">Inheritance</a></li>
        <li><a href="#interfaces-extension-methods">Interfaces &#x2B; Extension Methods</a></li>
            <ul>
        <li><a href="#defining-the-interface">Defining the interface</a></li>
        <li><a href="#defining-the-extension-method">Defining the extension method</a></li>
        <li><a href="#interface-implementation">Interface implementation</a></li>
            </ul>
        <li><a href="#conclusion">Conclusion</a></li>
            </ul>
        </div>

                    </div>
            </div>
            <div class="row ">
                    <div id="content" class="col-md-9">
                        <div>
    <script src="https://giscus.app/client.js"
            data-repo="always-developing/always-developing.github.io"
            data-repo-id="R_kgDOGQJLBQ"
            data-category="Comments"
            data-category-id="DIC_kwDOGQJLBc4B_pUA"
            data-mapping="pathname"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="bottom"
            data-theme="transparent_dark"
            data-lang="en"
            crossorigin="anonymous"
            async>
    </script>
</div>
                    </div>
            </div>
    </div>

    <hr class="horizontal-rule" />

    <!-- Footer -->
    <footer>
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center">
                <ul class="list-inline text-center">
                    <li class="list-inline-item">
                        <a href="https://github.com/always-developing">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse footer-icon"></i>
                            </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://www.linkedin.com/in/jean-pierre-seini">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-linkedin fa-stack-1x fa-inverse footer-icon"></i>
                            </span>
                        </a>
                    </li>
                </ul>
                <div>
                    <p class="copyright text-footer">
                        Copyright © 2023 Always Developing</a>.
                    </p>
                </div>
                <ul class="list-inline text-center small text-feeds">
                        <li class="list-inline-item">
                            <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                        </li>
                        <li class="list-inline-item">
                            <a href="/feed.atom"><i class="fa fa-rss"></i> Atom Feed</a>
                        </li>
                </ul>
                <ul class="list-inline text-center small">
                    <li class="list-inline-item">
                        <a href="https://github.com/always-developing/alwaysdeveloping-website-src"><i class="fab fa-github"></i> This site on GitHub</a>                    
                    </li>
                    <li class="list-inline-item">
                        |
                    </li>
                    <li class="list-inline-item">
                        <a href="https://github.com/always-developing/alwaysdeveloping-website-src/tree/main/theme"><i class="fa fa-code"></i> Custom Always-Developing theme</a>
                    </li>
                    <li class="list-inline-item">
                        |
                    </li>
                    <li class="list-inline-item">
                        <a href="https://github.com/statiqdev/CleanBlog"><i class="fa fa-blog"></i> Adapted from Clean Blog theme</a>
                    </li>
                </ul>
                <div class="small text-footer">
                    <a href="https://statiq.dev"><i class="fa fa-cogs"></i> Generated by Statiq</a>
                </div>
            </div>
        </div>
    </div>
</footer>

    <!-- Bootstrap core JavaScript -->
    <script src="/vendor/jquery/jquery.min.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CXPLFS7K38"></script>

<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CXPLFS7K38');
</script>

    

    <!-- Custom scripts for this template -->
    <script src="/js/always-developing-blog.js"></script>

</body>

</html>
