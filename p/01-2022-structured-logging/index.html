<!doctype html><html lang=en-uk>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An introduction to what, why and how of structured logging using Serilog"><title>Structured logging - an introduction</title><link rel=canonical href=https://always-developing.github.io/p/01-2022-structured-logging/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Structured logging - an introduction">
<meta property="og:description" content="An introduction to what, why and how of structured logging using Serilog">
<meta property="og:url" content="https://always-developing.github.io/p/01-2022-structured-logging/">
<meta property="og:site_name" content="Always Developing">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="c#"><meta property="article:tag" content=".net"><meta property="article:tag" content="logging"><meta property="article:tag" content="structuredlogging"><meta property="article:tag" content="serilog"><meta property="article:tag" content="structured"><meta property="article:tag" content="logger"><meta property="article:published_time" content="2022-01-31T03:00:00+02:00"><meta property="article:modified_time" content="2022-01-31T03:00:00+02:00">
<meta name=twitter:title content="Structured logging - an introduction">
<meta name=twitter:description content="An introduction to what, why and how of structured logging using Serilog">
<link rel="shortcut icon" href=favicon.ico>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CXPLFS7K38"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CXPLFS7K38",{anonymize_ip:!1})}</script>
</head><body class="article-page has-toc">
<script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"dark")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://always-developing.github.io/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div><main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/blog/>
Blog
</a>
</header><h2 class=article-title>
<a href=/p/01-2022-structured-logging/>Structured logging - an introduction</a>
</h2><h3 class=article-subtitle>
An introduction to what, why and how of structured logging using Serilog
</h3><footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Jan 31, 2022</time>
</div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
10 minute read
</time>
</div></footer></div></header><section class=article-content>
<h2 id=introduction>Introduction</h2><p>This post will give an introduction to <code>structured logging</code>, why its needed and should be used. It will also go into detail how to implement and customize the output using Serilog.</p><hr>
<h2 id=default-net-logging>Default .NET Logging</h2><p>Before looking at structured logging, we&rsquo;ll take a look at the default .NET logging implementation.</p><p>The default logger can be utilized by injecting <code>ILogger&lt;CategoryName></code> into the relevant constructor. The <em>ILogger&lt;></em> interface and its implementation are registered automatically with the .NET dependency injection container on startup.</p><p>Let&rsquo;s look at an example using the default minimal API project template (using .NET6). This is not representative of a real production scenario, and is used only for demo purposes (e.g. an exception generally should not be caught, logged and ignored)</p><p>Below is a <strong>modified</strong> version of the default <em>GET</em> endpoint which is included as part of the template.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1> 1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2> 2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3> 3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4> 4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5> 5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6> 6</a>
</span><span class=lnt id=ienumusage-7><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-7> 7</a>
</span><span class=lnt id=ienumusage-8><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-8> 8</a>
</span><span class=lnt id=ienumusage-9><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-9> 9</a>
</span><span class=lnt id=ienumusage-10><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-10>10</a>
</span><span class=lnt id=ienumusage-11><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-11>11</a>
</span><span class=lnt id=ienumusage-12><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-12>12</a>
</span><span class=lnt id=ienumusage-13><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-13>13</a>
</span><span class=lnt id=ienumusage-14><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-14>14</a>
</span><span class=lnt id=ienumusage-15><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-15>15</a>
</span><span class=lnt id=ienumusage-16><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-16>16</a>
</span><span class=lnt id=ienumusage-17><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-17>17</a>
</span><span class=lnt id=ienumusage-18><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-18>18</a>
</span><span class=lnt id=ienumusage-19><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-19>19</a>
</span><span class=lnt id=ienumusage-20><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-20>20</a>
</span><span class=lnt id=ienumusage-21><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-21>21</a>
</span><span class=lnt id=ienumusage-22><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-22>22</a>
</span><span class=lnt id=ienumusage-23><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-23>23</a>
</span><span class=lnt id=ienumusage-24><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-24>24</a>
</span><span class=lnt id=ienumusage-25><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-25>25</a>
</span><span class=lnt id=ienumusage-26><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-26>26</a>
</span><span class=lnt id=ienumusage-27><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-27>27</a>
</span><span class=lnt id=ienumusage-28><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-28>28</a>
</span><span class=lnt id=ienumusage-29><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-29>29</a>
</span><span class=lnt id=ienumusage-30><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-30>30</a>
</span><span class=lnt id=ienumusage-31><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-31>31</a>
</span><span class=lnt id=ienumusage-32><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-32>32</a>
</span><span class=lnt id=ienumusage-33><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-33>33</a>
</span><span class=lnt id=ienumusage-34><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-34>34</a>
</span><span class=lnt id=ienumusage-35><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-35>35</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>app</span><span class=p>.</span><span class=n>MapGet</span><span class=p>(</span><span class=s>&#34;/weatherforecast&#34;</span><span class=p>,</span> <span class=p>(</span><span class=n>ILogger</span><span class=p>&lt;</span><span class=n>Program</span><span class=p>&gt;</span> <span class=n>logger</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=p>.</span><span class=n>LogDebug</span><span class=p>(</span><span class=s>&#34;weatherforecast: Entered&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>forecast</span> <span class=p>=</span> <span class=n>Enumerable</span><span class=p>.</span><span class=n>Range</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>5</span><span class=p>).</span><span class=n>Select</span><span class=p>(</span><span class=n>index</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>WeatherForecast</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>DateTime</span><span class=p>.</span><span class=n>Now</span><span class=p>.</span><span class=n>AddDays</span><span class=p>(</span><span class=n>index</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>Random</span><span class=p>.</span><span class=n>Shared</span><span class=p>.</span><span class=n>Next</span><span class=p>(-</span><span class=m>20</span><span class=p>,</span> <span class=m>55</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>summaries</span><span class=p>[</span><span class=n>Random</span><span class=p>.</span><span class=n>Shared</span><span class=p>.</span><span class=n>Next</span><span class=p>(</span><span class=n>summaries</span><span class=p>.</span><span class=n>Length</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>      <span class=p>))</span>
</span></span><span class=line><span class=cl>       <span class=p>.</span><span class=n>ToArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=p>.</span><span class=n>LogInformation</span><span class=p>(</span><span class=s>$&#34;Number of forecasts: &#39;{forecast.Count()}&#39;.&#34;</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>        <span class=s>$&#34; Max temperature of: &#39;{forecast.Max(x =&gt; x.TemperatureC)}&#39;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>forecast</span><span class=p>.</span><span class=n>Any</span><span class=p>(</span><span class=n>x</span> <span class=p>=&gt;</span> <span class=n>x</span><span class=p>.</span><span class=n>TemperatureC</span> <span class=p>&gt;</span> <span class=m>50</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>Exception</span><span class=p>(</span><span class=s>&#34;Temperature is too high&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>ex</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=p>.</span><span class=n>LogError</span><span class=p>(</span><span class=n>ex</span><span class=p>.</span><span class=n>Message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>finally</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=p>.</span><span class=n>LogDebug</span><span class=p>(</span><span class=s>&#34;weatherforecast: Exit&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>forecast</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=n>WithName</span><span class=p>(</span><span class=s>&#34;GetWeatherForecast&#34;</span><span class=p>);</span></span></span></code></pre></td></tr></table></div></div><ul>
<li><strong>Line 1</strong>: ILogger&lt;> is injected. The same can be done using the constructor of any class.</li><li><strong>Line 3 & 30</strong>: A debug message is logged when the method is entered and exited.</li><li><strong>Line 14 & 15</strong>: An informational message is logged to give some context as to what the method output.</li><li><strong>Line 19-22</strong>: If any of the temperature values about to be returned are greater than 50C, throw a exception.</li><li><strong>Line 24-27</strong>: Catch any exceptions, and log the error message.</li></ul><p>The output when the application is run, and the above method is invoked, is as follows:</p><p><figure class=gallery-image style=flex-grow:210;flex-basis:505px>
<a href=/p/01-2022-structured-logging/1.DefaultOutput.png data-size=750x356>
<img src=/p/01-2022-structured-logging/1.DefaultOutput.png width=750 height=356 srcset="/p/01-2022-structured-logging/1.DefaultOutput_hu4256ada5982373518066d16c5c5d4363_32369_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/1.DefaultOutput_hu4256ada5982373518066d16c5c5d4363_32369_1024x0_resize_box_3.png 1024w" loading=lazy alt="Default logger output">
</a>
<figcaption>Default logger output</figcaption></figure></p><ul>
<li>The <strong>log level</strong> (e.g. debug, information, error) is reflected on the left hand side, in the various colours.</li><li>The <strong>Program [0]</strong> shown refers to the <em>CategoryName</em> of the ILogger instance. This is determine by the full name (namespace + class name) of the generic parameter used when injecting <em>ILogger&lt;></em>.
<ul>
<li>In the above example, <code>ILogger&lt;Program></code> is injected, so the category is the full name of <code>Program</code>, which in this example is just <em>Program</em>.</li><li>The <strong>[0]</strong> refers to an <strong>EventId</strong> (in this case, this has not been set)</li></ul></li></ul><p>The <strong>Logging</strong> section in the appsettings.json file can be used to determine the minimum log level for a specific category name, or for all categories.
Below is a sample the appsettings.json <strong>Logging</strong> section:</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1>1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2>2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3>3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4>4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5>5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6>6</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;Logging&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;LogLevel&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Default&#34;</span><span class=p>:</span> <span class=s2>&#34;Information&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;Microsoft.AspNetCore&#34;</span><span class=p>:</span> <span class=s2>&#34;Error&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>In the above example, as the default log level is <strong>&ldquo;Information&rdquo;</strong>, invoking <em>logger.LogDebug</em> would not output any data as <em>debug has a lower log level than information</em>.<br>
In additional, any log calls which have a category name of <strong>&ldquo;Microsoft.AspNetCore&rdquo;</strong> will not be logged unless <em>error or above</em> is being logged.</p><p>This mechanism can be used to log different types of data, based on the category of the data.</p><p>There is more to the default .NET logging infrastructure, not covered in this post - see the references below which contain a link to the official .NET logging documentation.</p><hr>
<h2 id=the-issue-with-default-logging>The issue with default logging</h2><p>The default logging described above works well, and there is <code>nothing inherently "wrong" with it</code>.</p><p>However, the big problem is that there is <code>no consistency with the structure of the information being output</code>.</p><ul>
<li><strong>What time was the message output?</strong></li><li><strong>What application logged the message?</strong> Especially important if multiple application are logging to a central location</li><li><strong>How to identity if multiple message are related or linked to each other?</strong> How can we tell which messages are all related to a single http request, especially if multiple requests are being served at the same time?</li></ul><p>There is also the question of how a collection of messages in various different formats can easily be indexed and searched.</p><p>These could all be addressed by manually making sure that each and every time any message is logged that it:</p><ul>
<li>Contains the date and time</li><li>Contains the application name</li><li>Contains a context/request id</li></ul><p>However, there is still no guaranteed message structure and format - this is where structured logging steps in.<br>
<code>Structured logging ensures that any information which is output, is always done so in a consistent, structured, well-defined format</code>.</p><hr>
<h2 id=structured-logging>Structured logging</h2><p>.NET doesn&rsquo;t perform structured logging out the box, so a 3rd party library will be used - <a class=link href=https://serilog.net/ target=_blank rel=noopener><code>Serilog</code></a>. Serilog has become the defacto standard for doing structured logging due to its ease of use, and configurability.</p><p>Serilog works by replacing the default <em>ILogger&lt;></em> implementation with its own implementation - so no changes are required to any part of the code which use any <em>ILogger</em> methods. The application only needs to be configured on startup to use the Serilog implementation instead of the default one.</p><blockquote>
<div>
<div style=width:5%;float:left;vertical-align:middle;padding-right:60px>
<i class=inline-svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-info-circle" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#00abfb" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><line x1="12" y1="8" x2="12.01" y2="8"/><polyline points="11 12 12 12 12 16 13 16"/></svg></i>
</div><div>
<p><strong>Serilog</strong> can be configured to send the log messages to one or multiple <em>sink(s)</em>, which are data destinations. In the samples below only the console sink will be configured</p></div></div></blockquote><p>In the below example. the <code>Serilog</code>, <code>Serilog.AspNetCore</code> and <code>Serilog.Sinks.Console</code> NuGet packages have been added to the project.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1> 1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2> 2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3> 3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4> 4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5> 5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6> 6</a>
</span><span class=lnt id=ienumusage-7><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-7> 7</a>
</span><span class=lnt id=ienumusage-8><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-8> 8</a>
</span><span class=lnt id=ienumusage-9><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-9> 9</a>
</span><span class=lnt id=ienumusage-10><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-10>10</a>
</span><span class=lnt id=ienumusage-11><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-11>11</a>
</span><span class=lnt id=ienumusage-12><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-12>12</a>
</span><span class=lnt id=ienumusage-13><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-13>13</a>
</span><span class=lnt id=ienumusage-14><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-14>14</a>
</span><span class=lnt id=ienumusage-15><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-15>15</a>
</span><span class=lnt id=ienumusage-16><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-16>16</a>
</span><span class=lnt id=ienumusage-17><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-17>17</a>
</span><span class=lnt id=ienumusage-18><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-18>18</a>
</span><span class=lnt id=ienumusage-19><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-19>19</a>
</span><span class=lnt id=ienumusage-20><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-20>20</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>using</span> <span class=nn>Serilog</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>builder</span> <span class=p>=</span> <span class=n>WebApplication</span><span class=p>.</span><span class=n>CreateBuilder</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>AddEndpointsApiExplorer</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>AddSwaggerGen</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Host</span><span class=p>.</span><span class=n>UseSerilog</span><span class=p>((</span><span class=n>context</span><span class=p>,</span> <span class=n>loggerConfig</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>loggerConfig</span><span class=p>.</span><span class=n>WriteTo</span><span class=p>.</span><span class=n>Console</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>app</span> <span class=p>=</span> <span class=n>builder</span><span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Configure the HTTP request pipeline.</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>app</span><span class=p>.</span><span class=n>Environment</span><span class=p>.</span><span class=n>IsDevelopment</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=n>UseSwagger</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=n>UseSwaggerUI</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p><strong>Lines 1</strong> as well as <strong>lines 8-11</strong> were the only changes made to the application. The code is configuring the builder host (an IHostBuilder implementation) to <em>Use Serilog</em>, and then configures which sinks to <em>Write To</em>.<br>
As <code>Serilog.Sinks.Console</code> is the only Serilog sink package added to the project, only &ldquo;WriteTo.<em>Console</em>&rdquo; is available.</p><p>By adding just these few lines, Serilog now takes over the implementation of <em>ILogger&lt;></em>, and the output now looks as follows:</p><p><figure class=gallery-image style=flex-grow:272;flex-basis:653px>
<a href=/p/01-2022-structured-logging/2.DefaultSerilog.png data-size=771x283>
<img src=/p/01-2022-structured-logging/2.DefaultSerilog.png width=771 height=283 srcset="/p/01-2022-structured-logging/2.DefaultSerilog_hu22e13ecc521dce1e02b289c16e96f78d_200941_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/2.DefaultSerilog_hu22e13ecc521dce1e02b289c16e96f78d_200941_1024x0_resize_box_3.png 1024w" loading=lazy alt="Default Serilog output">
</a>
<figcaption>Default Serilog output</figcaption></figure></p><p>The format of the output is <code>now always in a standard format</code>, the Serilog <em>default output template</em> which is <code>{Timestamp:HH:mm:ss} [{EventType:x8} {Level:u3}] {Message:lj}{NewLine}{Exception}</code></p><p>However, the <em>output template</em> can be updated and customized, which will be explored in the next section.</p><hr>
<h2 id=refine-and-customize>Refine and customize</h2><h3 id=object-parameters>Object parameters</h3><p>One important aspect of Serilog, is that it will <code>automatically serialize object parameters to JSON and reflect that in the output</code>, while the default .NET ILogger implementation will <code>call the ToString() method on the object</code>.</p><p>In our sample, this actually results in the same output, as <code>WeatherForecast is a record</code> and it&rsquo;s <em>ToString()</em> implementation will return a JSON representation of the record.</p><p>If the ILogger is used to log a <em>record of type WeatherForecast</em>:</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1>1</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl>    <span class=n>logger</span><span class=p>.</span><span class=n>LogInformation</span><span class=p>(</span><span class=s>&#34;Forecast[0]: {@WeatherForecast}&#34;</span><span class=p>,</span> <span class=n>forecasts</span><span class=p>[</span><span class=m>0</span><span class=p>]);</span></span></span></code></pre></td></tr></table></div></div><p>The output message is the same, just in different output formats:</p><p>Default .NET ILogger:
<figure class=gallery-image style=flex-grow:1313;flex-basis:3152px>
<a href=/p/01-2022-structured-logging/3.RecordDefault.png data-size=683x52>
<img src=/p/01-2022-structured-logging/3.RecordDefault.png width=683 height=52 srcset="/p/01-2022-structured-logging/3.RecordDefault_hu524fb6f72e1535ff81a194032081f5b6_5337_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/3.RecordDefault_hu524fb6f72e1535ff81a194032081f5b6_5337_1024x0_resize_box_3.png 1024w" loading=lazy alt="Default logger record output">
</a>
<figcaption>Default logger record output</figcaption></figure></p><p>Serilog:<br>
<figure class=gallery-image style=flex-grow:2154;flex-basis:5170px>
<a href=/p/01-2022-structured-logging/4.RecordSerilog.png data-size=754x35>
<img src=/p/01-2022-structured-logging/4.RecordSerilog.png width=754 height=35 srcset="/p/01-2022-structured-logging/4.RecordSerilog_hubd1db66782def2765088df03ba5dc203_6198_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/4.RecordSerilog_hubd1db66782def2765088df03ba5dc203_6198_1024x0_resize_box_3.png 1024w" loading=lazy alt="Serilog record output">
</a>
<figcaption>Serilog record output</figcaption></figure></p><p>However, <code>if WeatherForecast was a class, instead of a record, the output would be vastly different</code>.</p><p>Assume that WeatherForecast is now a class with the same fields as the record, and that forecasts[0] is an instance of <code>class WeatherForecast</code>:</p><p>Default .NET ILogger:
<figure class=gallery-image style=flex-grow:994;flex-basis:2387px>
<a href=/p/01-2022-structured-logging/5.ClassDefault.png data-size=388x39>
<img src=/p/01-2022-structured-logging/5.ClassDefault.png width=388 height=39 srcset="/p/01-2022-structured-logging/5.ClassDefault_hu1b5ec291168a448f006e895ffb746a64_2296_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/5.ClassDefault_hu1b5ec291168a448f006e895ffb746a64_2296_1024x0_resize_box_3.png 1024w" loading=lazy alt="Default logger class output">
</a>
<figcaption>Default logger class output</figcaption></figure></p><p>Serilog:<br>
<figure class=gallery-image style=flex-grow:2054;flex-basis:4929px>
<a href=/p/01-2022-structured-logging/6.ClassSerilog.png data-size=760x37>
<img src=/p/01-2022-structured-logging/6.ClassSerilog.png width=760 height=37 srcset="/p/01-2022-structured-logging/6.ClassSerilog_huf6efa1907e1c5c6b9d258e6df8f5c59a_7221_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/6.ClassSerilog_huf6efa1907e1c5c6b9d258e6df8f5c59a_7221_1024x0_resize_box_3.png 1024w" loading=lazy alt="Serilog class output">
</a>
<figcaption>Serilog class output</figcaption></figure></p><p>The default <code>.NET ILogger outputs the ToString() result</code>, while Serilog <code>outputs a the result of serializing the object</code> (as well as including the object type).</p><hr>
<h3 id=output-customization>Output customization</h3><p>There are a couple of ways to change the output format:</p><h4 id=output-format>Output Format</h4><p>When specifying which sinks to write to, it is possible to <em>overwrite the default output template for that sink</em>. In the below example,</p><ol>
<li>The log level has been moved to the start of the template</li><li>A constant application name (&ldquo;StructuredLoggingDemo&rdquo;) has been included</li><li>Milliseconds now included in the time stamp</li></ol><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1>1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2>2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3>3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4>4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5>5</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Host</span><span class=p>.</span><span class=n>UseSerilog</span><span class=p>((</span><span class=n>context</span><span class=p>,</span> <span class=n>loggerConfig</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=n>loggerConfig</span><span class=p>.</span><span class=n>WriteTo</span><span class=p>.</span><span class=n>Console</span><span class=p>(</span><span class=n>outputTemplate</span><span class=p>:</span> <span class=s>&#34;[{EventType:x8} {Level:u3}] =&gt; &#34;</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;StructuredLoggingDemo: {Timestamp:HH:mm:ss:ms} {Message:lj}{NewLine}{Exception}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></td></tr></table></div></div><p>This results in the output looking as follows, with the updates mentioned above included:</p><p><figure class=gallery-image style=flex-grow:1186;flex-basis:2846px>
<a href=/p/01-2022-structured-logging/7.CustomTemplate.png data-size=854x72>
<img src=/p/01-2022-structured-logging/7.CustomTemplate.png width=854 height=72 srcset="/p/01-2022-structured-logging/7.CustomTemplate_hu422ab64a66f39f48ff84a181ed719bde_16592_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/7.CustomTemplate_hu422ab64a66f39f48ff84a181ed719bde_16592_1024x0_resize_box_3.png 1024w" loading=lazy alt="Custom output template">
</a>
<figcaption>Custom output template</figcaption></figure></p><p>Serilog, and by extension the template, can also be enriched with additional properties at runtime.</p><p>Below Serilog is enriched with:</p><ul>
<li>The application name, using reflection</li><li>The application start up date (admittedly, not the most useful thing to include on <em>every</em> log message, but acceptable for a demo application)</li></ul><p>These additional properties are then being utilized in the output template with the format <code>{Enrich_Property_Name}</code> ({ApplicationName} and {StartupDate} in the below example)</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1> 1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2> 2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3> 3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4> 4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5> 5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6> 6</a>
</span><span class=lnt id=ienumusage-7><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-7> 7</a>
</span><span class=lnt id=ienumusage-8><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-8> 8</a>
</span><span class=lnt id=ienumusage-9><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-9> 9</a>
</span><span class=lnt id=ienumusage-10><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-10>10</a>
</span><span class=lnt id=ienumusage-11><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-11>11</a>
</span><span class=lnt id=ienumusage-12><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-12>12</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Host</span><span class=p>.</span><span class=n>UseSerilog</span><span class=p>((</span><span class=n>context</span><span class=p>,</span> <span class=n>loggerConfig</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>loggerConfig</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Enrich</span><span class=p>.</span><span class=n>WithProperty</span><span class=p>(</span><span class=s>&#34;ApplicationName&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>Assembly</span><span class=p>.</span><span class=n>GetExecutingAssembly</span><span class=p>().</span><span class=n>GetName</span><span class=p>().</span><span class=n>Name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Enrich</span><span class=p>.</span><span class=n>WithProperty</span><span class=p>(</span><span class=s>&#34;StartupDate&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>DateTime</span><span class=p>.</span><span class=n>Now</span><span class=p>.</span><span class=n>ToShortDateString</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WriteTo</span><span class=p>.</span><span class=n>Console</span><span class=p>(</span><span class=n>outputTemplate</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=s>&#34;[{EventType:x8} {Level:u3}] =&gt; {ApplicationName} &#34;</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;({StartupDate}): {Timestamp:HH:mm:ss:ms}&#34;</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34; {Message:lj}{NewLine}{Exception}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></td></tr></table></div></div><p>This results in the output looking as follows, with the updates mentioned above:</p><p><figure class=gallery-image style=flex-grow:1147;flex-basis:2753px>
<a href=/p/01-2022-structured-logging/8.RevisedCustomTemplate.png data-size=826x72>
<img src=/p/01-2022-structured-logging/8.RevisedCustomTemplate.png width=826 height=72 srcset="/p/01-2022-structured-logging/8.RevisedCustomTemplate_hu7a44f434b71dc1ebcea5e37bf2d4df27_13713_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/8.RevisedCustomTemplate_hu7a44f434b71dc1ebcea5e37bf2d4df27_13713_1024x0_resize_box_3.png 1024w" loading=lazy alt="Enriched output template">
</a>
<figcaption>Enriched output template</figcaption></figure></p><p>Custom enrichers can also be written to automatically enrich the logger with specific set of properties. There are also a number of <a class=link href="https://www.nuget.org/packages?q=serilog.enrichers" target=_blank rel=noopener>enrichers available &ldquo;out the box&rdquo; as NuGet packages</a>, which when included make the values available for use in the output template.</p><p>For example, the <a class=link href=https://www.nuget.org/packages/Serilog.Enrichers.Environment/2.2.0 target=_blank rel=noopener>Serilog.Enrichers.Environment</a> package will enrich the logger with System Environment properties.</p><h4 id=formatters>Formatters</h4><p>Serilog also the concept of <code>formatters</code> - which are used to <code>change and customize the format of the output</code>. In the preceding examples, the output has been in plain text - a formatter can be used to output the <em>entire output message</em> in JSON, for example.</p><p>There are a number <a class=link href="https://www.nuget.org/packages?q=Serilog.Formatting" target=_blank rel=noopener>formatters available &ldquo;out the box&rdquo; as NuGet packages</a>.</p><p>In the below example, the <code>Serilog.Formatting.Compact</code> NuGet package has been referenced, and the <code>CompactJsonFormatter</code> added to the Serilog configuration.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1>1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2>2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3>3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4>4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5>5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6>6</a>
</span><span class=lnt id=ienumusage-7><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-7>7</a>
</span><span class=lnt id=ienumusage-8><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-8>8</a>
</span><span class=lnt id=ienumusage-9><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-9>9</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Host</span><span class=p>.</span><span class=n>UseSerilog</span><span class=p>((</span><span class=n>context</span><span class=p>,</span> <span class=n>loggerConfig</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>loggerConfig</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Enrich</span><span class=p>.</span><span class=n>WithProperty</span><span class=p>(</span><span class=s>&#34;ApplicationName&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>Assembly</span><span class=p>.</span><span class=n>GetExecutingAssembly</span><span class=p>().</span><span class=n>GetName</span><span class=p>().</span><span class=n>Name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>Enrich</span><span class=p>.</span><span class=n>WithProperty</span><span class=p>(</span><span class=s>&#34;StartupDate&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>            <span class=n>DateTime</span><span class=p>.</span><span class=n>Now</span><span class=p>.</span><span class=n>ToShortDateString</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>.</span><span class=n>WriteTo</span><span class=p>.</span><span class=n>Console</span><span class=p>(</span><span class=k>new</span> <span class=n>CompactJsonFormatter</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></td></tr></table></div></div><p>This results in the output as follows:</p><p><figure class=gallery-image style=flex-grow:777;flex-basis:1866px>
<a href=/p/01-2022-structured-logging/9.CompactOutput.png data-size=902x116>
<img src=/p/01-2022-structured-logging/9.CompactOutput.png width=902 height=116 srcset="/p/01-2022-structured-logging/9.CompactOutput_hu27bc1af81ed8d752eb197bb989f5fea9_20800_480x0_resize_box_3.png 480w, /p/01-2022-structured-logging/9.CompactOutput_hu27bc1af81ed8d752eb197bb989f5fea9_20800_1024x0_resize_box_3.png 1024w" loading=lazy alt="Compact JSON output">
</a>
<figcaption>Compact JSON output</figcaption></figure></p><p>At first glance, <code>this is harder to read - so why would we want to output the messages in this format?</code></p><hr>
<h2 id=benefits-of-structured-output>Benefits of structured output</h2><p>While the output above is definitely harder to read as is, in a production environment its not often that output would be written directly to the console. Its more often that the data would be sent to a log analyzing system (such as <a class=link href=https://www.elastic.co/what-is/elk-stack target=_blank rel=noopener>The ELK Stack</a>, <a class=link href=https://www.datadoghq.com/ target=_blank rel=noopener>Datadog</a> or one of the many alternatives) for consumption.</p><p>These systems allow for:</p><ul>
<li>The consumption of log data</li><li>The analysis of log data</li><li>Visualization of log data</li></ul><p>With the <code>entire output being structured as JSON</code> (not just the message portion as in earlier examples), the entire output can now be easily indexed, searched, analyzed and visualized.</p><div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt id=ienumusage-1><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-1> 1</a>
</span><span class=lnt id=ienumusage-2><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-2> 2</a>
</span><span class=lnt id=ienumusage-3><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-3> 3</a>
</span><span class=lnt id=ienumusage-4><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-4> 4</a>
</span><span class=lnt id=ienumusage-5><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-5> 5</a>
</span><span class=lnt id=ienumusage-6><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-6> 6</a>
</span><span class=lnt id=ienumusage-7><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-7> 7</a>
</span><span class=lnt id=ienumusage-8><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-8> 8</a>
</span><span class=lnt id=ienumusage-9><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-9> 9</a>
</span><span class=lnt id=ienumusage-10><a style=outline:none;text-decoration:none;color:inherit href=#ienumusage-10>10</a>
</span></code></pre></td><td class=lntd>
<pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@t&#34;</span><span class=p>:</span> <span class=s2>&#34;2022-01-22T04:44:31.8254123Z&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@mt&#34;</span><span class=p>:</span> <span class=s2>&#34;Number of forecasts: &#39;5&#39;. Max temperature of: &#39;43&#39;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;SourceContext&#34;</span><span class=p>:</span> <span class=s2>&#34;Program&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;RequestId&#34;</span><span class=p>:</span> <span class=s2>&#34;0HMETC7FHFGLL:00000003&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;RequestPath&#34;</span><span class=p>:</span> <span class=s2>&#34;/weatherforecast&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ConnectionId&#34;</span><span class=p>:</span> <span class=s2>&#34;0HMETC7FHFGLL&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;ApplicationName&#34;</span><span class=p>:</span> <span class=s2>&#34;StructuredLoggingDemo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;StartupDate&#34;</span><span class=p>:</span> <span class=s2>&#34;2022/01/22&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></td></tr></table></div></div><p>In addition to the above benefits, there is also the performance aspect. The <code>volume</code> of output data as well as the <code>output format</code> and <code>template format</code> all have an impact on performance. This should be taken into account and benchmarked for each use case.</p><p>In my experience, the <code>CompactJsonFormatter</code> output was faster and had a better memory impact when compared with default .NET and default Serilog functionality.</p><hr>
<h2 id=log-levels>Log levels</h2><p>A note on log levels - Serilog provides the same functionality as the default .NET ILogger implementation, with regards to setting the minimum log level at a <code>default global level</code>, at a <code>category name level</code> and at a <code>storage/sink level</code>.</p><p>The configuration of Serilog is different to that of the default ILogger, but they both essentially provide the same capabilities.</p><p>See the references for additional documentation with more details.</p><hr>
<h2 id=conclusion>Conclusion</h2><p>There is a log more detail and functionality provided by both the default .NET ILogger implementation as well as the Serilog implementation. Additional resources are provided below should you want to dive deeper into the capabilities of either of the implementations.<br>
However after reading this post, you should now have an understanding of the <em>basic functionality</em> of each, how to refine and customize the output to suite your applications needs, as well as why structured logging can be beneficial to performance and data visibility.</p><hr>
<h2 id=references>References</h2><p><a class=link href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-6.0" target=_blank rel=noopener>Logging in .NET Core and ASP.NET Core - official documentation</a><br>
<a class=link href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging/?view=aspnetcore-6.0#log-level" target=_blank rel=noopener>.NET Core and ASP.NET Core log levels</a><br>
<a class=link href=https://github.com/serilog/serilog/wiki/ target=_blank rel=noopener>Serilog Wiki</a><br>
<a class=link href=https://github.com/serilog/serilog/wiki/Configuration-Basics#minimum-level target=_blank rel=noopener>Serilog log levels</a><br>
<a class=link href="https://www.nuget.org/packages?q=serilog.enrichers" target=_blank rel=noopener>Serilog enrichers</a><br>
<a class=link href="https://www.nuget.org/packages?q=Serilog.Formatting" target=_blank rel=noopener>Serilog formatters</a></p></section><footer class=article-footer>
<section class=article-tags>
<a href=/tags/c#/>c#</a>
<a href=/tags/.net/>.net</a>
<a href=/tags/logging/>logging</a>
<a href=/tags/structuredlogging/>structuredlogging</a>
<a href=/tags/serilog/>serilog</a>
<a href=/tags/structured/>structured</a>
<a href=/tags/logger/>logger</a>
</section></footer></article><aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2><div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/p/01-2022-git-workflow/>
<div class=article-details>
<h2 class=article-title>Git workflows - explained</h2></div></a>
</article><article>
<a href=/p/12-2021-devops-symbol-server/>
<div class=article-details>
<h2 class=article-title>Azure Devops Symbol Server - a how to guide</h2></div></a>
</article><article>
<a href=/p/11-2020-dynamic-context/>
<div class=article-details>
<h2 class=article-title>Dynamic Context (for Entity Framework Core)</h2></div></a>
</article><article>
<a href=/p/analyzer-extra/>
<div class=article-details>
<h2 class=article-title>Roslyn Analyzer - tips and tricks (Part 5)</h2></div></a>
</article><article>
<a href=/p/analyzer-test/>
<div class=article-details>
<h2 class=article-title>Roslyn Analyzer - testing an analyzer and code fix (Part 4)</h2></div></a>
</article></div></div></aside><script src=https://giscus.app/client.js data-repo=always-developing/always-developing.github.io data-repo-id=R_kgDOGQJLBQ data-category=Comments data-category-id=DIC_kwDOGQJLBc4B_pUA data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light crossorigin=anonymous async></script>
<script>function setGiscusTheme(t){let e=document.querySelector("iframe.giscus-frame");e&&e.contentWindow.postMessage({giscus:{setConfig:{theme:t}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){document.documentElement.dataset.scheme==="light"?setGiscusTheme("light"):setGiscusTheme("dark")}})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 -
2022 Always Developing
</section><section class=powerby>
Always Developing | always learning | always growing <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.2.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div><div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main><aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#introduction>Introduction</a></li><li><a href=#default-net-logging>Default .NET Logging</a></li><li><a href=#the-issue-with-default-logging>The issue with default logging</a></li><li><a href=#structured-logging>Structured logging</a></li><li><a href=#refine-and-customize>Refine and customize</a>
<ol>
<li><a href=#object-parameters>Object parameters</a></li><li><a href=#output-customization>Output customization</a>
<ol>
<li><a href=#output-format>Output Format</a></li><li><a href=#formatters>Formatters</a></li></ol></li></ol></li><li><a href=#benefits-of-structured-output>Benefits of structured output</a></li><li><a href=#log-levels>Log levels</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#references>References</a></li></ol></nav></div></section></aside></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script>
</body></html>